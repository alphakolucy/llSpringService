<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title></title>
		<link rel="stylesheet" href="../layui/css/layui.css" media="all">
		<style type="text/css">
			.show {
				width: 750px;
				margin: 0 auto;
				text-align: center;
			}

			.show .showimg {
				position: relative;
				width: 350px;
				height: 350px;
				border: 1px solid #707070;
				display: inline-block;
			}

			.show .showimg .img {
				width: 350px;
				height: 350px;
			}

			.show .showimg .img img {
				width: 100%;
				height: 100%;
			}

			.show .showimg .chooseimg {
				position: absolute;
				left: 50%;
				top: 50%;
				height: 50px;
				width: 50px;
				margin: -25px 0 0 -25px;
			}

			.show .showimg .chooseimg img {
				width: 100%;
				height: 100%;
				cursor: pointer;
			}

			.show .show-pdding {
				margin-left: 20px;
			}

			.listpic {
				width: 830px;
				margin: 0 auto;
				padding-top: 5px;
			}

			.listpic .pic {
				position: relative;
				width: 160px;
				height: 160px;
				display: inline-block;
				border: 1px solid #707070;
				margin: 5px 2px;
			}

			.listpic .pic .picshow {
				width: 150px;
				height: 150px;
				padding: 4px;
			}

			.listpic .pic .picshow img {
				width: 100%;
				height: 100%;
				cursor: pointer;
			}

			.listpic .pic .picoprate {
				position: absolute;
				right: 10px;
				top: 10px;
			}

			.listpic .pic .picoprate img {
				width: 20px;
				height: 20px;
				cursor: pointer;
				margin-left: 5px;
			}
			.fileupload {
				width: 960px;
				height: 674px;
				font-size: 0;
				display: block;
				border: 1px solid #F2F2F2;
			}
			
			.fileupload .filetype {
				display: inline-block;
				width: 120px;
				font-size: 14px;
				background-color: rgba(242, 242, 242, 0.5);
				vertical-align: top;
				height: 674px;
				color: #666666;
			}
			
			.fileupload .filetype ul li {
				line-height: 40px;
				border-bottom: 1px solid #666666;
				text-align: center;
				cursor: pointer;
			}
			
			.fileupload .filetype ul .active {
				color: #F2F2F2;
				background-color: #666666;
			}
			
			.fileupload .filetype ul li:hover {
				color: #F2F2F2;
				background-color: #666666;
			}
			
			.fileupload .filedata {
				display: inline-block;
				width: 840px;
				vertical-align: top;
				height: 674px;
			}
			
			.layui-none {
				font-size: 15px;
			}
		</style>
	</head>
	<body>
		<div class="layui-tab" lay-filter="pointtabs">
			<ul class="layui-tab-title">
				<li class="layui-this">基本信息</li>
				<li>位置图</li>
				<li>地质图</li>
				<li>柱状图/剖面图</li>
				<li>水质分析</li>
				<li>成因模式</li>
				<li>附件</li>
			</ul>
			<div class="layui-tab-content">
				<div class="layui-tab-item layui-show">
					<!--基本信息-->
					<form class="layui-form" action="" lay-filter="pointinfo">
						<b>基本信息</b>
						<div class="layui-row layui-hide">
							<div class="layui-col-md6">
								<div class="layui-form-item">
									<label class="layui-form-label">id</label>
									<div class="layui-input-block">
										<input type="text" name="id" required lay-verify="required" placeholder="请输入" autocomplete="off" class="layui-input">
									</div>
								</div>
							</div>
						</div>
						<div class="layui-row">
							<div class="layui-col-md6">
								<div class="layui-form-item">
									<label class="layui-form-label">编号</label>
									<div class="layui-input-block">
										<input type="text" name="codeNumber" readonly="readonly" required lay-verify="required" placeholder="请输入" autocomplete="off"
										 class="layui-input">
									</div>
								</div>
							</div>
						
							<div class="layui-col-md6">
								<div class="layui-form-item">
									<label class="layui-form-label">位置名称</label>
									<div class="layui-input-block">
										<input type="text" name="address" readonly="readonly" required lay-verify="required" placeholder="请输入" autocomplete="off"
										 class="layui-input">
									</div>
								</div>
							</div>
						
						</div>
						
						
						<div class="layui-row">
							<div class="layui-col-md4">
								<div class="layui-form-item">
									<label class="layui-form-label">x</label>
									<div class="layui-input-block">
										<input type="text" name="x" required lay-verify="required" readonly="readonly" placeholder="请输入" autocomplete="off"
										 class="layui-input">
									</div>
								</div>
							</div>
						
							<div class="layui-col-md4">
								<div class="layui-form-item">
									<label class="layui-form-label">y</label>
									<div class="layui-input-block">
										<input type="text" name="y" required lay-verify="required" readonly="readonly" placeholder="请输入"
										 autocomplete="off" class="layui-input">
									</div>
								</div>
							</div>
						
							<div class="layui-col-md4">
								<div class="layui-form-item">
									<label class="layui-form-label">海拔(m)</label>
									<div class="layui-input-block">
										<input type="text" name="z" readonly="readonly" required lay-verify="required" placeholder="请输入" autocomplete="off"
										 class="layui-input">
									</div>
								</div>
							</div>
						
						</div>
						
						
						<div class="layui-row">
							<div class="layui-col-md4">
								<div class="layui-form-item">
									<label class="layui-form-label">孔深(m)</label>
									<div class="layui-input-block">
										<input type="text" name="holeDepth" readonly="readonly" required lay-verify="required" placeholder="请输入" autocomplete="off"
										 class="layui-input">
									</div>
								</div>
							</div>
						
							<div class="layui-col-md4">
								<div class="layui-form-item">
									<label class="layui-form-label">PH</label>
									<div class="layui-input-block">
										<input type="text" name="ph" readonly="readonly" required lay-verify="required" placeholder="请输入" autocomplete="off"
										 class="layui-input">
									</div>
								</div>
							</div>
						
							<div class="layui-col-md4">
								<div class="layui-form-item">
									<label class="layui-form-label">水温(℃)</label>
									<div class="layui-input-block">
										<input type="text" name="waterTemperature" readonly="readonly" required lay-verify="required" placeholder="请输入"
										 autocomplete="off" class="layui-input">
									</div>
								</div>
							</div>
						</div>
						
						<div class="layui-row">
							<div class="layui-col-md4">
								<div class="layui-form-item">
									<label class="layui-form-label">涌水量(L/D)</label>
									<div class="layui-input-block">
										<input type="text" name="waterInflow" readonly="readonly" required lay-verify="required" placeholder="请输入"
										 autocomplete="off" class="layui-input">
									</div>
								</div>
							</div>
						
							<div class="layui-col-md4">
								<div class="layui-form-item">
									<label class="layui-form-label">开孔/出露层位</label>
									<div class="layui-input-block">
										<input type="text" name="trepanning" readonly="readonly" required lay-verify="required" placeholder="请输入"
										 autocomplete="off" class="layui-input">
									</div>
								</div>
							</div>
						
							<div class="layui-col-md4">
								<div class="layui-form-item">
									<label class="layui-form-label">出水段</label>
									<div class="layui-input-block">
										<input type="text" name="waterOutlet" readonly="readonly" required lay-verify="required" placeholder="请输入"
										 autocomplete="off" class="layui-input">
									</div>
								</div>
							</div>
						</div>
						
						<b>理疗天然矿泉水水质指标</b>
						<div class="layui-row">
							<div class="layui-col-md4">
								<div class="layui-form-item">
									<label class="layui-form-label">TDS(mg/L)</label>
									<div class="layui-input-block">
										<input type="text" name="dissolvedSolids" readonly="readonly" required lay-verify="required" placeholder="请输入"
										 autocomplete="off" class="layui-input">
									</div>
								</div>
							</div>
						
							<div class="layui-col-md4">
								<div class="layui-form-item">
									<label class="layui-form-label">CO<sub>2</sub>(mg/L)</label>
									<div class="layui-input-block">
										<input type="text" name="co2" required readonly="readonly" lay-verify="required" placeholder="请输入" autocomplete="off"
										 class="layui-input">
									</div>
								</div>
							</div>
						
							<div class="layui-col-md4">
								<div class="layui-form-item">
									<label class="layui-form-label">H<sub>2</sub>S+HS<sup>-</sup>(mg/L)</label>
									<div class="layui-input-block">
										<input type="text" name="hydrothion" required readonly="readonly" lay-verify="required" placeholder="请输入" autocomplete="off"
										 class="layui-input">
									</div>
								</div>
							</div>
						</div>
						
						<div class="layui-row">
							<div class="layui-col-md4">
								<div class="layui-form-item">
									<label class="layui-form-label">H<sub>2</sub>SiO<sub>3</sub>(mg/L)</label>
									<div class="layui-input-block">
										<input type="text" name="hsio" required readonly="readonly" lay-verify="required" placeholder="请输入" autocomplete="off"
										 class="layui-input">
									</div>
								</div>
							</div>
						
							<div class="layui-col-md4">
								<div class="layui-form-item">
									<label class="layui-form-label">HBO<sub>2</sub>(mg/L)</label>
									<div class="layui-input-block">
										<input type="text" name="hbo2" readonly="readonly" required lay-verify="required" placeholder="请输入" autocomplete="off"
										 class="layui-input">
									</div>
								</div>
							</div>
						
							<div class="layui-col-md4">
								<div class="layui-form-item">
									<label class="layui-form-label">Br(mg/L)</label>
									<div class="layui-input-block">
										<input type="text" name="br2" readonly="readonly" required lay-verify="required" placeholder="请输入" autocomplete="off"
										 class="layui-input">
									</div>
								</div>
							</div>
						</div>
						
						<div class="layui-row">
							<div class="layui-col-md4">
								<div class="layui-form-item">
									<label class="layui-form-label">I<sup>-</sup>(mg/L)</label>
									<div class="layui-input-block">
										<input type="text" name="i2" readonly="readonly" required lay-verify="required" placeholder="请输入" autocomplete="off"
										 class="layui-input">
									</div>
						
								</div>
							</div>
						
							<div class="layui-col-md4">
								<div class="layui-form-item">
									<label class="layui-form-label">Fe<sup>2+</sup>+Fe<sup>3+</sup>(mg/L)</label>
									<div class="layui-input-block">
										<input type="text" name="fe" readonly="readonly" required lay-verify="required" placeholder="请输入" autocomplete="off"
										 class="layui-input">
									</div>
								</div>
							</div>
						
							<div class="layui-col-md4">
								<div class="layui-form-item">
									<label class="layui-form-label">As(mg/L)</label>
									<div class="layui-input-block">
										<input type="text" name="asa" readonly="readonly" required lay-verify="required" placeholder="请输入" autocomplete="off"
										 class="layui-input">
									</div>
								</div>
							</div>
						</div>
						
						<div class="layui-row">
							<div class="layui-col-md4">
								<div class="layui-form-item">
									<label class="layui-form-label"><sup>222</sup>Rn(mg/L)</label>
									<div class="layui-input-block">
										<input type="text" name="rn"readonly="readonly" required lay-verify="required" placeholder="请输入" autocomplete="off"
										 class="layui-input">
									</div>
								</div>
							</div>
						
							<div class="layui-col-md4">
								<div class="layui-form-item">
									<label class="layui-form-label">水化学类型</label>
									<div class="layui-input-block">
										<input type="text" name="hydrochemicalType" readonly="readonly" required lay-verify="required" placeholder="请输入"
										 autocomplete="off" class="layui-input">
									</div>
								</div>
							</div>
						</div>
					</form>
				</div>

				<div class="layui-tab-item">
					<!--位置图-->
					<div>
<!--						<button type="button" class="layui-btn" id="seat">-->
<!--							<i class="layui-icon">&#xe60d;</i>上传图片-->
<!--						</button>-->
						<div>
							<table class="layui-hide" id="list0" lay-data="{id: 'pointlist0'}" lay-filter="imagedemo"></table>
						</div>
					</div>
				</div>

				<div class="layui-tab-item">
					<!--地质图-->
					<div>
<!--						<button type="button" class="layui-btn" id="geology">-->
<!--							<i class="layui-icon">&#xe60d;</i>上传图片-->
<!--						</button>-->
						<div>
							<table class="layui-hide" id="list1" lay-data="{id: 'pointlist1'}" lay-filter="imagedemo"></table>
						</div>
					</div>
				</div>

				<div class="layui-tab-item">
					<!--柱状图/剖面图-->
					<div>
<!--						<button type="button" class="layui-btn" id="columnar">-->
<!--							<i class="layui-icon">&#xe60d;</i>上传图片-->
<!--						</button>-->
						<div>
							<table class="layui-hide" id="list2" lay-data="{id: 'pointlist2'}" lay-filter="imagedemo"></table>
						</div>
					</div>
				</div>
				<div class="layui-tab-item">
					<!--水质分析-->
					<div>
<!--						<button type="button" class="layui-btn" id="waterquality">-->
<!--							<i class="layui-icon">&#xe60d;</i>上传图片-->
<!--						</button>-->
						<div>
							<table class="layui-hide" id="list3" lay-data="{id: 'pointlist3'}" lay-filter="imagedemo"></table>
						</div>
					</div>
				</div>
				<div class="layui-tab-item">
					<!--成因模式-->
					<div>
<!--						<button type="button" class="layui-btn" id="model">-->
<!--							<i class="layui-icon">&#xe60d;</i>上传图片-->
<!--						</button>-->
						<div>
							<table class="layui-hide" id="list4" lay-data="{id: 'pointlist4'}" lay-filter="imagedemo"></table>
						</div>
					</div>
				</div>
				<div class="layui-tab-item">
					<!--附件-->
					<div class="fileupload">
						<div class="filetype" id="filetype">
							<ul>
								<li class="active" packagetype="0">收集资料</li>
								<li packagetype="1">野外资料</li>
								<li packagetype="2">测试分析报告</li>
								<li packagetype="3">成果报告</li>
								<li packagetype="4">照片</li>
								<li packagetype="5">企业资料</li>
							</ul>
						</div>
						<div class="filedata">
<!--							<button type="button" class="layui-btn" id="uploadfile">-->
<!--								<i class="layui-icon">&#xe67c;</i>上传附件-->
<!--							</button>-->
							<div>
								<table class="layui-hide" id="list" lay-data="{id: 'pointlist'}" lay-filter="demo"></table>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<script type="text/javascript" src="../Api.js"></script>
		<script type="text/javascript" src="../layui/layui.js"></script>
		<script type="text/javascript">
			var curpointdata = parent.curpointjson;
			layui.use(['upload', 'element', 'form', 'jquery','table'], function() {
				var upload = layui.upload;
				var element = layui.element;
				var form = layui.form;
				var $ = layui.jquery;
				var table=layui.table;
				//获取数据接口
				var inputs = $("form").find("input");
				$.each(inputs, function(index, item) {
					var attrname=$(this).attr("name");
					
					$(item).val(curpointdata[attrname]);
					if(waterstanard.hasOwnProperty(attrname)){
						var val=$(this).val();
						if(curpointdata[attrname]>waterstanard[attrname]){
							$(this).parent().parent().css("color","#FF0000");
							$(this).css("color","#FF0000");
						}
					}
					//遍历得到的每一个jquery对象
				});
				form.render();
				// form.val("pointinfo", curpointdata);
				var imagesidnex = 0;
				var imagelist = [
					[],
					[],
					[],
					[],
					[],
					[]
				];
				element.on('tab(pointtabs)', function(elem) {
					switch (elem.index) {
						case 0:
							{
								break;
							}
						case 1:
							{
								imagesidnex = 0;
								table.reload('pointlist' + imagesidnex, {
									data: imagelist[imagesidnex]
								});
								break;
							}
						case 2:
							{
								imagesidnex = 1;
								table.reload('pointlist' + imagesidnex, {
									data: imagelist[imagesidnex]
								});
								break;
							}
						case 3:
							{
								imagesidnex = 2;
								table.reload('pointlist' + imagesidnex, {
									data: imagelist[imagesidnex]
								});
								break;
							}
						case 4:
							{
								imagesidnex = 3;
								table.reload('pointlist' + imagesidnex, {
									data: imagelist[imagesidnex]
								});
								break;
							}
						case 5:
							{
								imagesidnex = 4;
								table.reload('pointlist' + imagesidnex, {
									data: imagelist[imagesidnex]
								});
								break;
							}
						case 6:
							{
								break;
							}
						default:
							break;
					}
				});
				//获取历史图片并渲染成表格,同时渲染上传控件
				var picStates = [{
					"id": "#seat",
					"picState": 10001
				}, {
					"id": "#geology",
					"picState": 10002
				}, {
					"id": "#columnar",
					"picState": 10003
				}, {
					"id": "#waterquality",
					"picState": 10004
				}, {
					"id": "#model",
					"picState": 10005
				}];
				$.each(picStates, function(index, item) {
					$.ajax({
						type: "GET",
						url: apiUrl + "/springPoint/findPicFileHistory",
						dataType: "json",
						data: {
							"pointId": curpointdata.id,
							"picState": item.picState
						},
						success: function(data) {
							if (data.code == 200) {
								imagelist[index]=data.springPicFileList;
								table.render({
									elem: '#list' + index,
									id: 'pointlist' + index,
									cols: [
										[{
												field: 'id',
												title: 'ID',
												hide: true,
											}, {
												field: 'fileName',
												title: '文件名称'
											}, {
												field: 'plottingScale',
												title: '比例尺'
											}, {
												field: 'createTime',
												title: '上传时间'
											},
											{
												title: '操作',
												width: 200,
												toolbar: '#imagebarDemo'
											}
										]
									],
									data: imagelist[index],
									page: true
								});
							} else {
								table.render({
									elem: '#list' + index,
									id: 'pointlist' + index,
									cols: [
										[{
												field: 'id',
												title: 'ID',
												hide: true,
											}, {
												field: 'fileName',
												title: '文件名称'
											}, {
												field: 'fileName',
												title: '比例尺'
											}, {
												field: 'createTime',
												title: '上传时间'
											},
											{
												title: '操作',
												width: 160,
												toolbar: '#imagebarDemo'
											}
										]
									],
									data: imagelist[index],
									page: true
								});
							}
						},
						error: function(data) {
							console.log(data);
							// layer.msg('删除失败', {
							// 	icon: 5,
							// 	time: 1000
							// }, function() {});
						}
					});
				})


				var fileslist = [
					[],
					[],
					[],
					[],
					[],
					[]
				];
				var packagetype = 0;
				//切换附件类型
				$("#filetype ul li").on("click", function() {
					if ($(this).hasClass('active')) {
						return false;
					} else {
						var listli = $("#filetype").find("li");
						listli.removeClass('active');
						$(this).addClass('active');
						packagetype = $(this).attr("packagetype");
						table.reload('pointlist', {
							data: fileslist[packagetype]
						});
					}
				
				});
				var packagetypes=[0,1,2,3,4,5];
				table.render({
					elem: '#list',
					id: 'pointlist',
					cols: [
						[{
								field: 'id',
								title: 'ID',
								hide: true,
							}, {
								field: 'fileName',
								title: '文件名称'
							}, {
								field: 'createTime',
								title: '上传时间'
							},
							{
								title: '操作',
								width: 160,
								toolbar: '#barDemo'
							}
						]
					],
					data: [],
					page: true
				});
				$.each(packagetypes,function(index,item){
					$.ajax({
						type: "GET",
						url: apiUrl + "/springPoint/findPointAllPicFile",
						dataType: "json",
						data: {
							"pointId": curpointdata.id,
							"picState": 10006,
							"packageType":item
						},
						success: function(data) {
							if (data.code == 200) {
								fileslist[index]=data.springPicFileList;
								if(index==packagetype){
									table.reload('pointlist', {
										data: fileslist[packagetype]
									});
								}
							}
							else{
								
							}
						},
						error: function(data) {
							console.log(data);
							// layer.msg('删除失败', {
							// 	icon: 5,
							// 	time: 1000
							// }, function() {});
						}
					});
				});
			});
		</script>

        <script type="text/html" id="imagebarDemo">
            <a class="layui-btn layui-btn-primary layui-btn-xs" lay-event="detail">查看</a>

        </script>
	</body>
</html>
